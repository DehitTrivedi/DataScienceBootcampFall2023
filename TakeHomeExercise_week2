Week 2 : SQL 

Question 1 : Write a SQL query to Pull total number of orders that were completed on 18th March 2023
Answer 1 : 

SELECT COUNT(*) AS TotalOrders
FROM SALES
WHERE Date = '2023-03-18';

Question 2 : Write SQL query to Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name ‘Doe’
Answer 2 : 

SELECT COUNT(*) AS TotalOrders
FROM SALES
INNER JOIN CUSTOMERS ON SALES.Customer_id = CUSTOMERS.Customer_id
WHERE Date = '2023-03-18' AND First_name = 'John' AND Last_name = 'Doe';


Question 3 : Write a SQL query to Pull total number of customers that purchased in January 2023 and the average amount spend per customer
Answer 3 : 

SELECT COUNT(DISTINCT Customer_id) AS TotalCustomers, AVG(Revenue) AS AverageRevenue
FROM SALES
WHERE Date >= '2023-01-01' AND Date <= '2023-01-31';


Question 4 : Write a SQL query to Pull the departments that generated less than $600 in 2022
Answer 4 : 

SELECT DISTINCT department
FROM SALES
INNER JOIN ITEMS ON SALES.Item_id = ITEMS.Item_id
WHERE Date >= '2022-01-01' AND Date <= '2022-12-31'
GROUP BY department
HAVING SUM(Revenue) < 600;


Question 5 : Write a SQL query to compute What is the most and least revenue we have generated by an order
Answer 5 : 

SELECT MAX(Revenue) AS MaxRevenue, MIN(Revenue) AS MinRevenue
FROM SALES;


Question 6 : Write a SQL query to compute What were the orders that were purchased in our most lucrative order
Answer 6 :

SELECT *
FROM SALES
WHERE Revenue = (SELECT MAX(Revenue) FROM SALES);
