Week 2 : SQL 

Question 1 : Write a SQL query to Pull total number of orders that were completed on 18th March 2023
Answer 1 : 

SELECT COUNT(*) AS TotalCompletedOrders
FROM Orders
WHERE CompletionDate = '2023-03-18';

Question 2 : Write SQL query to Pull total number of orders that were completed on 18th March 2023 with the first name ‘John’ and last name ‘Doe’
Answer 2 : 

SELECT COUNT(Orders.OrderID) AS TotalCompletedOrders
FROM Orders
JOIN Customers ON Orders.CustomerID = Customers.CustomerID
WHERE Orders.CompletionDate = '2023-03-18'
  AND Customers.FirstName = 'John'
  AND Customers.LastName = 'Doe';

Question 3 : Write a SQL query to Pull total number of customers that purchased in January 2023 and the average amount spend per customer
Answer 3 : 

SELECT
    COUNT(DISTINCT Orders.CustomerID) AS TotalCustomers,
    AVG(Orders.Amount) AS AverageAmountPerCustomer
FROM
    Orders
WHERE
    Orders.OrderDate >= '2023-01-01' AND Orders.OrderDate <= '2023-01-31';


Question 4 : Write a SQL query to Pull the departments that generated less than $600 in 2022
Answer 4 : 

SELECT
    Department,
    SUM(Amount) AS TotalRevenue
FROM
    Revenue
WHERE
    YEAR(Date) = 2022
GROUP BY
    Department
HAVING
    SUM(Amount) < 600;


Question 5 : Write a SQL query to compute What is the most and least revenue we have generated by an order
Answer 5 : 

SELECT
    MAX(Revenue) AS MostRevenue,
    MIN(Revenue) AS LeastRevenue
FROM
    Orders;

Question 6 : Write a SQL query to compute What were the orders that were purchased in our most lucrative order
Answer 6 :

SELECT
    OrderID,
    OrderDate,
    Revenue
FROM
    Orders
WHERE
    Revenue = (SELECT MAX(Revenue) FROM Orders);

